(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[478],{2733:function(e,s,t){Promise.resolve().then(t.bind(t,8171))},7614:function(e,s,t){"use strict";var r=t(7415);t(4482);let a=t(5994);s.Z=class{async request(e,s){var t,a,o,n,i,l,c;try{let n=await e();return(null==s?void 0:s.notify_success)&&(null===(t=String(n.status))||void 0===t?void 0:t.startsWith("2"))&&r.toast.success("".concat((null==n?void 0:null===(a=n.data)||void 0===a?void 0:a.message)||(null==n?void 0:null===(o=n.data)||void 0===o?void 0:o.status))),n}catch(e){return(null==s?void 0:s.notify_error)&&((null==e?void 0:null===(i=e.response)||void 0===i?void 0:null===(n=i.data)||void 0===n?void 0:n.message)?r.toast.error("".concat(null==e?void 0:null===(c=e.response)||void 0===c?void 0:null===(l=c.data)||void 0===l?void 0:l.message)):e.message&&r.toast.error("".concat(e.message))),e.response}}constructor(){this.jwtHeader,this.jwtHeader=window.localStorage.getItem("jwt"),this.http=a.create({baseURL:"".concat("https://natours-back-end-f19a9ffbcdd5.herokuapp.com/"),timeout:3e4,headers:{"X-Custom-Header":"foobar",jwt:this.jwtHeader},withCredentials:!0})}}},2216:function(e,s,t){"use strict";var r=t(7614);let bookingsApi=class bookingsApi extends r.Z{async getCheckoutSession(e){let s=await this.request(()=>this.http.get("/api/v1/bookings/checkout-session/".concat(e)));if(s)return s}async getMyBookings(){let e=await this.request(()=>this.http.get("/api/v1/bookings/my"));if(e.data.data)return e.data.data}async createBooking(e,s,t){let r=await this.request(()=>this.http.post("/api/v1/bookings/",{tour:e,user:s,price:t}),{notify_success:!1,notify_error:!1});if(r)return r}constructor(){super()}};s.Z=new bookingsApi},8171:function(e,s,t){"use strict";t.r(s);var r=t(7437),a=t(2265),o=t(4033),n=t(5632),i=t(2216);s.default=function(){let[e,s]=(0,a.useState)(!1),[t,l]=(0,a.useState)({}),c=(0,o.useSearchParams)(),{push:u}=(0,o.useRouter)(),handleBookingPayment=async()=>{let e=await i.Z.createBooking(t.tourId,t.userId,t.price);String(null==e?void 0:e.status).startsWith("2")?u("/info/success/booking/","replace"):(null==e?void 0:e.data.error.message)?u("/info/error/error/".concat(e.data.error.message),"replace"):(null==e?void 0:e.data.message)?u("/info/error/error/".concat(e.data.message),"replace"):u("/info/error/error/Something went wrong","replace")};return(0,a.useEffect)(()=>{l({tourId:c.get("tourId"),userId:c.get("userId"),price:c.get("price")})},[]),(0,a.useEffect)(()=>{(null==t?void 0:t.tourId)&&(null==t?void 0:t.userId)&&(null==t?void 0:t.price)&&!e&&(s(!0),handleBookingPayment())},[t,e]),(0,r.jsx)("div",{className:"min-h-[90vh] flex justify-center items-center ",children:(0,r.jsx)(n.Z,{})})}},5632:function(e,s,t){"use strict";var r=t(7437);t(2265),t(6691),t(6096);let BikeSVG=e=>{let{className:s}=e;return(0,r.jsx)("svg",{className:"bike ".concat(s),viewBox:"0 0 48 30",width:"48px",height:"30px",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsxs)("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1",children:[(0,r.jsxs)("g",{transform:"translate(9.5,19)",children:[(0,r.jsx)("circle",{className:"bike__tire",r:"9",strokeDasharray:"56.549 56.549"}),(0,r.jsxs)("g",{className:"bike__spokes-spin",strokeDasharray:"31.416 31.416",strokeDashoffset:"-23.562",children:[(0,r.jsx)("circle",{className:"bike__spokes",r:"5"}),(0,r.jsx)("circle",{className:"bike__spokes",r:"5",transform:"rotate(180,0,0)"})]})]}),(0,r.jsx)("g",{transform:"translate(24,19)",children:(0,r.jsxs)("g",{className:"bike__pedals-spin",strokeDasharray:"25.133 25.133",strokeDashoffset:"-21.991",transform:"rotate(67.5,0,0)",children:[(0,r.jsx)("circle",{className:"bike__pedals",r:"4"}),(0,r.jsx)("circle",{className:"bike__pedals",r:"4",transform:"rotate(180,0,0)"})]})}),(0,r.jsxs)("g",{transform:"translate(38.5,19)",children:[(0,r.jsx)("circle",{className:"bike__tire",r:"9",strokeDasharray:"56.549 56.549"}),(0,r.jsxs)("g",{className:"bike__spokes-spin",strokeDasharray:"31.416 31.416",strokeDashoffset:"-23.562",children:[(0,r.jsx)("circle",{className:"bike__spokes",r:"5"}),(0,r.jsx)("circle",{className:"bike__spokes",r:"5",transform:"rotate(180,0,0)"})]})]}),(0,r.jsx)("polyline",{className:"bike__seat",points:"14 3,18 3",strokeDasharray:"5 5"}),(0,r.jsx)("polyline",{className:"bike__body",points:"16 3,24 19,9.5 19,18 8,34 7,24 19",strokeDasharray:"79 79"}),(0,r.jsx)("path",{className:"bike__handlebars",d:"m30,2h6s1,0,1,1-1,1-1,1",strokeDasharray:"10 10"}),(0,r.jsx)("polyline",{className:"bike__front",points:"32.5 2,38.5 19",strokeDasharray:"19 19"})]})})};s.Z=function(e){let{className:s}=e;return(0,r.jsx)("div",{className:"text-green-emerald ",children:(0,r.jsx)(BikeSVG,{className:s})})}},679:function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),function(e,s){for(var t in s)Object.defineProperty(e,t,{enumerable:!0,get:s[t]})}(s,{unstable_getImgProps:function(){return unstable_getImgProps},default:function(){return l}});let r=t(1024),a=t(7929),o=t(2637),n=t(413),i=r._(t(9950)),unstable_getImgProps=e=>{(0,o.warnOnce)("Warning: unstable_getImgProps() is experimental and may change or be removed at any time. Use at your own risk.");let{props:s}=(0,a.getImgProps)(e,{defaultLoader:i.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,t]of Object.entries(s))void 0===t&&delete s[e];return{props:s}},l=n.Image},6096:function(){},6691:function(e,s,t){e.exports=t(679)},4033:function(e,s,t){e.exports=t(94)}},function(e){e.O(0,[248,413,971,472,744],function(){return e(e.s=2733)}),_N_E=e.O()}]);