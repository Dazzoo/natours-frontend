(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[559],{6677:function(e,t,s){"use strict";var r=s(7614);let authApi=class authApi extends r.Z{constructor(){super()}async SignUp(e,t,s,r){let a=await this.request(()=>this.http.post("/api/v1/users/signup",{name:e,email:t,password:s,passwordConfirm:r,role:"user"}),{notify_success:!0,notify_error:!0});if(String(a.status)?.startsWith("2"))return!0}async Login(e,t){let s=await this.request(()=>this.http.post("/api/v1/users/login",{email:e,password:t}),{notify_error:!0});if(s?.data.token)return s.data.token}async getMe(e){let t=await this.request(()=>this.http.get("/api/v1/users/me"));if(t?.data.data.data)return t.data.data.data}async logOut(e){let t=await this.request(()=>this.http.get("/api/v1/users/logout"));if(t?.data.status)return t.data.status}async updateUserInfo(e,t,s){let r=await this.request(()=>this.http.patch("/api/v1/users/update-info",{name:e,email:t,password:s}),{notify_success:!0,notify_error:!0});if(r?.status)return r.status}async updateUserPassword(e,t,s){let r=await this.request(()=>this.http.patch("/api/v1/users/update-password",{password:e,passwordNew:t,passwordConfirmNew:s}),{notify_success:!0,notify_error:!0});if(r?.status)return r.status}async ForgotPassword(e){let t=await this.request(()=>this.http.post("/api/v1/users/forgot-password",{email:e}),{notify_success:!1,notify_error:!1});if(t)return t}async ResetPassword(e,t,s){let r=await this.request(()=>this.http.patch(`/api/v1/users/reset-password/${e}`,{password:t,passwordConfirm:s}),{notify_success:!1,notify_error:!1});if(r)return r}async verifyEmail(e){let t=await this.request(()=>this.http.get(`/api/v1/users/verifyEmail/${e}`));if(t)return t}};t.Z=new authApi},5441:function(e,t,s){Promise.resolve().then(s.bind(s,1305)),Promise.resolve().then(s.bind(s,8229)),Promise.resolve().then(s.bind(s,6538)),Promise.resolve().then(s.t.bind(s,413,23)),Promise.resolve().then(s.bind(s,7415))},7614:function(e,t,s){"use strict";var r=s(7415);s(4482);let a=s(5994);t.Z=class{async request(e,t){var s,a,i,n,o,l,c;try{let n=await e();return(null==t?void 0:t.notify_success)&&(null===(s=String(n.status))||void 0===s?void 0:s.startsWith("2"))&&r.toast.success("".concat((null==n?void 0:null===(a=n.data)||void 0===a?void 0:a.message)||(null==n?void 0:null===(i=n.data)||void 0===i?void 0:i.status))),n}catch(e){return(null==t?void 0:t.notify_error)&&((null==e?void 0:null===(o=e.response)||void 0===o?void 0:null===(n=o.data)||void 0===n?void 0:n.message)?r.toast.error("".concat(null==e?void 0:null===(c=e.response)||void 0===c?void 0:null===(l=c.data)||void 0===l?void 0:l.message)):e.message&&r.toast.error("".concat(e.message))),e.response}}constructor(){this.jwtHeader,this.jwtHeader=window.localStorage.getItem("jwt"),this.http=a.create({baseURL:"".concat("https://natours-back-end-f19a9ffbcdd5.herokuapp.com/"),timeout:3e4,headers:{"X-Custom-Header":"foobar",jwt:this.jwtHeader},withCredentials:!0})}}},2216:function(e,t,s){"use strict";var r=s(7614);let bookingsApi=class bookingsApi extends r.Z{async getCheckoutSession(e){let t=await this.request(()=>this.http.get("/api/v1/bookings/checkout-session/".concat(e)));if(t)return t}async getMyBookings(){let e=await this.request(()=>this.http.get("/api/v1/bookings/my"));if(e.data.data)return e.data.data}async createBooking(e,t,s){let r=await this.request(()=>this.http.post("/api/v1/bookings/",{tour:e,user:t,price:s}),{notify_success:!1,notify_error:!1});if(r)return r}constructor(){super()}};t.Z=new bookingsApi},1305:function(e,t,s){"use strict";s.r(t);var r=s(7437),a=s(2265),i=s(1167),n=s(7078),o=s(4033),l=s(2216);t.default=function(e){let{tourId:t}=e,{user:s,loggedOut:c,isLoading:u,mutate:d}=(0,i.Z)(),[m,h]=(0,a.useState)(null),{push:p}=(0,o.useRouter)(),handleBookTour=async()=>{h("Processing.."),s||p("/login");{var e,r;let s=await l.Z.getCheckoutSession(t,null===(e=window.localStorage)||void 0===e?void 0:e.jwt);(null===(r=String(s.status))||void 0===r?void 0:r.startsWith("2"))&&s.data.data.url&&p(s.data.data.url)}h(null)};return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.Z,{value:m||"BOOK TOUR NOW!",className:"min-w-[20rem]",onClick:handleBookTour})})}},8229:function(e,t,s){"use strict";s.r(t);var r=s(7437);s(2265);var a=s(4685);s(7793);var i=s(9150),n=s(6691),o=s.n(n);t.default=function(e){var t;let createPhotoPath=e=>e?"".concat("https://natours-back-end-f19a9ffbcdd5.herokuapp.com/","/").concat(e.replace(/^public\\/,"")):null;return(0,r.jsx)("div",{className:" w-[100%] min-h-[40rem] select-none drag-none mr-[20%] relative",children:(0,r.jsx)(a.default,{responsive:{superLargeDesktop:{breakpoint:{max:4e3,min:3e3},items:5},desktop:{breakpoint:{max:3e3,min:1024},items:3},tablet:{breakpoint:{max:1210,min:464},items:2},mobile:{breakpoint:{max:660,min:0},items:1}},swipeable:!0,draggable:!0,showDots:!0,arrows:!1,ssr:!0,infinite:!0,autoPlaySpeed:1e3,keyBoardControl:!0,rewind:!0,rewindWithAnimation:!0,containerClass:"carousel-container",removeArrowOnDeviceType:["tablet","mobile"],dotListClass:"custom-dot-list-style-reviews  ",itemClass:"carousel-item-padding-40-px",children:null===(t=e.reviews)||void 0===t?void 0:t.map((e,t)=>{var s;return(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:"box-shadow-standard m-auto bg-white-alabaster rounded-[10px] w-[35rem] h-[35rem] flex flex-col content-center items-center  p-[5rem] mb-[5rem]",children:[(0,r.jsxs)("div",{className:" flex flex-col items-center ",children:[(0,r.jsx)("div",{className:"",children:(0,r.jsx)(o(),{className:"clip-path-circle w-full h-full max-w-[75px] max-h-[75px] ",width:75,height:75,src:createPhotoPath(null===(s=e.user)||void 0===s?void 0:s.photo.path)||"/img/no-user-image.gif"})}),(0,r.jsx)("div",{className:"uppercase text-[1.65rem] font-semibold ml-[1rem] pr-[1.5rem]  mt-[1rem]",children:null==e?void 0:e.user.name})]}),(0,r.jsx)("div",{className:"mt-[1rem]  h-[12rem] text-[1.5rem] italic overflow-hidden ",children:e.review}),(0,r.jsx)("div",{className:"inline-flex mt-[1rem]",children:[1,2,3,4,5].map(t=>Number(null==e?void 0:e.rating)>=t?(0,r.jsx)(i.pHD,{className:"h-[2.5rem] w-[2.5rem] fill-green-emerald stroke-green-emerald stroke-3 "}):(0,r.jsx)(i.y5j,{className:"h-[2.5rem] w-[2.5rem] fill-green-emerald stroke-green-emerald stroke-3 "}))})]})},e.id)})})})}},6538:function(e,t,s){"use strict";s.r(t),s.d(t,{dynamic:function(){return c},revalidate:function(){return l}});var r=s(7437),a=s(2265),i=s(3901),n=s.n(i);s(8262);var o=s(5632);n().accessToken="pk.eyJ1IjoiZGF6bzY1IiwiYSI6ImNsbWZoZmUyNzBxZjAzZXJ5aG5pc2FzbTkifQ.g3VGeiox7ukH5r_MDHTCyw";let l=!0,c="auto";t.default=e=>{let{locations:t,className:s,boundsPadding:i,boundsPaddingForMobile:l}=e,c=(0,a.useRef)(null),u=(0,a.useRef)(null),d=localStorage?localStorage.getItem("natours-theme"):null;return(0,a.useEffect)(()=>{u.current=new(n()).Map({container:c.current,style:"dark"===d?"mapbox://styles/mapbox/dark-v11":"mapbox://styles/mapbox/light-v11",center:t[0].coordinates,zoom:8});let e=new(n()).LngLatBounds;t.map(t=>{e.extend(t.coordinates)});let s=window.innerWidth<768&&l?l:null;return u.current.fitBounds(e,{padding:s||i}),t.map(e=>{new(n()).Marker().setLngLat(e.coordinates).addTo(u.current)}),()=>{u.current.remove()}},[t]),(0,r.jsx)(r.Fragment,{children:!(null==t?void 0:t.length)>0?(0,r.jsx)("div",{className:"mt-[30vh]",children:(0,r.jsx)(o.Z,{})}):(0,r.jsx)("div",{children:(0,r.jsx)("div",{ref:c,className:"".concat(s," min-h-[50rem] w-[100%]")})})})}},7078:function(e,t,s){"use strict";var r=s(7437);s(2265),t.Z=function(e){let{value:t,onClick:s,className:a}=e;return(0,r.jsx)("input",{className:"py-[1.25rem] text-[1.4rem] px-[3rem] bg-green-emerald rounded-[10rem] text-white flex self-center \n  uppercase hover:translate-y-[-2px] hover-button-shadow cursor-pointer transition duration-300 ".concat(a),type:"submit",value:t,onClick:s})}},5632:function(e,t,s){"use strict";var r=s(7437);s(2265),s(6691),s(6096);let BikeSVG=e=>{let{className:t}=e;return(0,r.jsx)("svg",{className:"bike ".concat(t),viewBox:"0 0 48 30",width:"48px",height:"30px",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsxs)("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1",children:[(0,r.jsxs)("g",{transform:"translate(9.5,19)",children:[(0,r.jsx)("circle",{className:"bike__tire",r:"9",strokeDasharray:"56.549 56.549"}),(0,r.jsxs)("g",{className:"bike__spokes-spin",strokeDasharray:"31.416 31.416",strokeDashoffset:"-23.562",children:[(0,r.jsx)("circle",{className:"bike__spokes",r:"5"}),(0,r.jsx)("circle",{className:"bike__spokes",r:"5",transform:"rotate(180,0,0)"})]})]}),(0,r.jsx)("g",{transform:"translate(24,19)",children:(0,r.jsxs)("g",{className:"bike__pedals-spin",strokeDasharray:"25.133 25.133",strokeDashoffset:"-21.991",transform:"rotate(67.5,0,0)",children:[(0,r.jsx)("circle",{className:"bike__pedals",r:"4"}),(0,r.jsx)("circle",{className:"bike__pedals",r:"4",transform:"rotate(180,0,0)"})]})}),(0,r.jsxs)("g",{transform:"translate(38.5,19)",children:[(0,r.jsx)("circle",{className:"bike__tire",r:"9",strokeDasharray:"56.549 56.549"}),(0,r.jsxs)("g",{className:"bike__spokes-spin",strokeDasharray:"31.416 31.416",strokeDashoffset:"-23.562",children:[(0,r.jsx)("circle",{className:"bike__spokes",r:"5"}),(0,r.jsx)("circle",{className:"bike__spokes",r:"5",transform:"rotate(180,0,0)"})]})]}),(0,r.jsx)("polyline",{className:"bike__seat",points:"14 3,18 3",strokeDasharray:"5 5"}),(0,r.jsx)("polyline",{className:"bike__body",points:"16 3,24 19,9.5 19,18 8,34 7,24 19",strokeDasharray:"79 79"}),(0,r.jsx)("path",{className:"bike__handlebars",d:"m30,2h6s1,0,1,1-1,1-1,1",strokeDasharray:"10 10"}),(0,r.jsx)("polyline",{className:"bike__front",points:"32.5 2,38.5 19",strokeDasharray:"19 19"})]})})};t.Z=function(e){let{className:t}=e;return(0,r.jsx)("div",{className:"text-green-emerald ",children:(0,r.jsx)(BikeSVG,{className:t})})}},1167:function(e,t,s){"use strict";s.d(t,{Z:function(){return useUser}});var r=s(2333),a=s(6677);function useUser(){let{data:e,mutate:t,isLoading:s,error:i}=(0,r.ZP)("getMe",async()=>await a.Z.getMe());return{loggedOut:!e&&!s,user:e,mutate:t,isLoading:s}}},6096:function(){}},function(e){e.O(0,[712,415,248,413,333,597,971,472,744],function(){return e(e.s=5441)}),_N_E=e.O()}]);