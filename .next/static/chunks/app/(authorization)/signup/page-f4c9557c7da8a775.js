(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[237],{6677:function(e,t,s){"use strict";var r=s(7614);let authApi=class authApi extends r.Z{constructor(){super()}async SignUp(e,t,s,r){let a=await this.request(()=>this.http.post("/api/v1/users/signup",{name:e,email:t,password:s,passwordConfirm:r,role:"user"}),{notify_success:!0,notify_error:!0});if(String(a.status)?.startsWith("2"))return!0}async Login(e,t){let s=await this.request(()=>this.http.post("/api/v1/users/login",{email:e,password:t}),{notify_error:!0});if(s?.data.token)return s.data.token}async getMe(e){let t=await this.request(()=>this.http.get("/api/v1/users/me"));if(t?.data.data.data)return t.data.data.data}async logOut(e){let t=await this.request(()=>this.http.get("/api/v1/users/logout"));if(t?.data.status)return t.data.status}async updateUserInfo(e,t,s){let r=await this.request(()=>this.http.patch("/api/v1/users/update-info",{name:e,email:t,password:s}),{notify_success:!0,notify_error:!0});if(r?.status)return r.status}async updateUserPassword(e,t,s){let r=await this.request(()=>this.http.patch("/api/v1/users/update-password",{password:e,passwordNew:t,passwordConfirmNew:s}),{notify_success:!0,notify_error:!0});if(r?.status)return r.status}async ForgotPassword(e){let t=await this.request(()=>this.http.post("/api/v1/users/forgot-password",{email:e}),{notify_success:!1,notify_error:!1});if(t)return t}async ResetPassword(e,t,s){let r=await this.request(()=>this.http.patch(`/api/v1/users/reset-password/${e}`,{password:t,passwordConfirm:s}),{notify_success:!1,notify_error:!1});if(r)return r}async verifyEmail(e){let t=await this.request(()=>this.http.get(`/api/v1/users/verifyEmail/${e}`));if(t)return t}};t.Z=new authApi},7838:function(e,t,s){Promise.resolve().then(s.bind(s,6641))},7614:function(e,t,s){"use strict";var r=s(7415);s(4482);let a=s(5994);t.Z=class{async request(e,t){var s,a,i,n,o,u,l;try{let n=await e();return(null==t?void 0:t.notify_success)&&(null===(s=String(n.status))||void 0===s?void 0:s.startsWith("2"))&&r.toast.success("".concat((null==n?void 0:null===(a=n.data)||void 0===a?void 0:a.message)||(null==n?void 0:null===(i=n.data)||void 0===i?void 0:i.status))),n}catch(e){return(null==t?void 0:t.notify_error)&&((null==e?void 0:null===(o=e.response)||void 0===o?void 0:null===(n=o.data)||void 0===n?void 0:n.message)?r.toast.error("".concat(null==e?void 0:null===(l=e.response)||void 0===l?void 0:null===(u=l.data)||void 0===u?void 0:u.message)):e.message&&r.toast.error("".concat(e.message))),e.response}}constructor(){this.jwtHeader,this.jwtHeader=window.localStorage.getItem("jwt"),this.http=a.create({baseURL:"".concat("https://natours-back-end-f19a9ffbcdd5.herokuapp.com/"),timeout:3e4,headers:{"X-Custom-Header":"foobar",jwt:this.jwtHeader},withCredentials:!0})}}},6641:function(e,t,s){"use strict";s.r(t);var r=s(7437);s(2265);var a=s(1865),i=s(7078),n=s(6677),o=s(4033),u=s(5691);t.default=function(e){let{setMessage:t}=e,{push:s}=(0,o.useRouter)(),{register:l,handleSubmit:c,formState:{errors:d},watch:p}=(0,a.cI)(),onSubmit=async e=>{await n.Z.SignUp(e["Your name"],e["Email address"],e.Password,e["Confirm password"])&&s("info/success/register/".concat(e["Your name"]))};return(0,r.jsxs)("form",{onSubmit:c(onSubmit),children:[(0,r.jsx)("div",{className:"flex flex-col mb-[2.5rem] relative",children:(0,r.jsx)(u.Z,{type:"text",required:!0,errors:d,register:l,pattern_value:/^.{3,20}$/,pattern_message:"Name length should not exceed 20 characters and should be at least 3 characters long",label:!0,name:"Your name"})}),(0,r.jsx)("div",{className:"flex flex-col mb-[2.5rem] relative",children:(0,r.jsx)(u.Z,{type:"text",required:!0,errors:d,register:l,pattern_value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,60}$/i,pattern_message:"Wrong email format",label:!0,name:"Email address"})}),(0,r.jsx)("div",{className:"flex flex-col mb-[2.5rem] relative",children:(0,r.jsx)(u.Z,{type:"password",required:!0,errors:d,register:l,pattern_value:/.{8,}/,pattern_message:"At least 8 characters is required",label:!0,name:"Password"})}),(0,r.jsx)("div",{className:"flex flex-col mb-[2.5rem] relative",children:(0,r.jsx)(u.Z,{type:"password",required:!0,errors:d,register:l,pattern_value:/.{8,}/,pattern_message:"At least 8 characters is required",label:!0,validate:e=>{let t=p("Password");return t===e||"Passwords do not match"},name:"Confirm password"})}),(0,r.jsx)("div",{className:"mt-[3rem]",children:(0,r.jsx)(i.Z,{value:"Register"})})]})}},7078:function(e,t,s){"use strict";var r=s(7437);s(2265),t.Z=function(e){let{value:t,onClick:s,className:a}=e;return(0,r.jsx)("input",{className:"py-[1.25rem] text-[1.4rem] px-[3rem] bg-green-emerald rounded-[10rem] text-white flex self-center \n  uppercase hover:translate-y-[-2px] hover-button-shadow cursor-pointer transition duration-300 ".concat(a),type:"submit",value:t,onClick:s})}},5691:function(e,t,s){"use strict";var r=s(7437),a=s(2265),i=s(3800);t.Z=function(e){var t;let{name:s,type:n,required:o,id:u,pattern_value:l,pattern_message:c,register:d,errors:p,validate:h,label:m}=e,[v,f]=(0,a.useState)(null);return(0,r.jsxs)("div",{className:"relative",children:[m?(0,r.jsx)("label",{className:" text-[1.6rem] font-bold mb-[0.75rem]",children:s}):null,(0,r.jsx)("input",{className:"bg-grey-concrete text-input-basic font-lato input-auth w-[100%] ".concat((null===(t=p[s])||void 0===t?void 0:t.type)||!l.test(v)?"input-auth-error-focus":"input-auth-valid-focus"),type:n,id:u,required:o,placeholder:s,...d("".concat(s),{pattern:{value:l,message:c},validate:h,onChange:e=>{let t=e.target.value;f(t)}})}),(0,r.jsx)("div",{className:"absolute top-[100%] text-orange-burning font-semibold text-[1.4rem]",children:(0,r.jsx)(i.B,{errors:p,name:s,render:e=>{let{message:t}=e;return(0,r.jsx)("p",{children:t})}})})]})}}},function(e){e.O(0,[248,918,971,472,744],function(){return e(e.s=7838)}),_N_E=e.O()}]);