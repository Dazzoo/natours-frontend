import Api from '@/api/api';

class authApi extends Api {
  constructor() {
    super();
  }

  async SignUp(name, email, password, passwordConfirm) {
    const response = await this.request(
      () =>
        this.http.post('/api/v1/users/signup', {
          name,
          email,
          password,
          passwordConfirm,
          role: 'user',
        }),
      {
        notify_success: true,
        notify_error: true,
      }
    );
    if (response.data.token) {
      return response.data.token;
    }
  }

  async Login(email, password) {
    const response = await this.request(
      () =>
        this.http.post('/api/v1/users/login', {
          email,
          password,
        }),
      {
        notify_success: true,
        notify_error: true,
      }
    );
    if (response.data.token) {
      return response.data.token;
    }
  }

  async getMe(jwt) {
    const response = await this.request(() =>
      this.http.get('/api/v1/users/me', { headers: { token: jwt } })
    );
    if (response?.data.data) {
      return response.data.data;
    }
  }
  async logOut() {
    const response = await this.request(() => this.http.get('/api/v1/users/logout'));
    if (response?.data.status) {
      return response.data.status;
    }
  }
}

export default new authApi();
